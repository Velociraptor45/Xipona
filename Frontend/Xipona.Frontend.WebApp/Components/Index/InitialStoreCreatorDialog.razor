@inherits Fluxor.Blazor.Web.Components.FluxorComponent

@using Fluxor
@using ProjectHermes.Xipona.Frontend.Redux.ShoppingList.Actions.InitialStoreCreator
@using ProjectHermes.Xipona.Frontend.Redux.ShoppingList.States

@inject IState<ShoppingListState> State
@inject IDispatcher Dispatcher

<Modal Title="Welcome"
       Visible="State.Value.InitialStoreCreator.IsOpen"
       Closable="false"
       MaskClosable="false"
       DestroyOnClose="true"
       Footer="GetFooter()">
    <div class="">
        Welcome to Xipona, your grocery and recipe assistant!
        <Input TValue="string" Placeholder="Store name" OnInput="OnNameInputChanged"></Input>
    </div>
</Modal>


@code
{
    private void OnNameInputChanged(ChangeEventArgs args)
    {
        Dispatcher.Dispatch(new InitialStoreNameChangedAction(args.Value?.ToString() ?? string.Empty));
    }

    private void OnCreateButtonClicked()
    {
        Dispatcher.Dispatch(new CreateInitialStoreAction());
    }

    public RenderFragment GetFooter()
    {
        return @<Template>
                   <Button
                       OnClick="OnCreateButtonClicked"
                       Type="@ButtonType.Primary"
                       Disabled="@(State.Value.InitialStoreCreator.Name.Length == 0)"
                       Loading="@State.Value.InitialStoreCreator.IsSaving">
                       Create
                   </Button>
               </Template>;
    }
}
